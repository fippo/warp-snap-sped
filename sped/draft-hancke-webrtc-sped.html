<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Embedding DTLS in STUN</title>
<meta content="Philipp Hancke" name="author">
<meta content="
       WebRTC uses the Interactive Connectivity Establishment (ICE) and Datagram Transport Layer Security (DTLS)
to establish secure connections. This document defines a protocol to embed the DTLS handshake into
the STUN packets used by ICE which allows parallelizing these sequential handshakes and reduces the number of round trips
it takes to establish a secure connection. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="webrtc" name="keyword">
<meta content="stun" name="keyword">
<meta content="dtls" name="keyword">
<meta content="draft-hancke-webrtc-sped-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.3.0
-->
<link href="draft-hancke-webrtc-sped.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
  border-left: 2px var(--pilcrow-strong) solid;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow, a.pilcrow:focus {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SPED</td>
<td class="right">February 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hancke</td>
<td class="center">Expires 7 August 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-hancke-webrtc-sped-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-02-03" class="published">3 February 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-08-07">7 August 2026</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. Hancke</div>
<div class="org">Meta Platforms Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Embedding DTLS in STUN</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">WebRTC uses the Interactive Connectivity Establishment (ICE) and Datagram Transport Layer Security (DTLS)
to establish secure connections. This document defines a protocol to embed the DTLS handshake into
the STUN packets used by ICE which allows parallelizing these sequential handshakes and reduces the number of round trips
it takes to establish a secure connection.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://fippo.github.io/warp-snap-sped/draft-hancke-webrtc-sped-latest.html">https://fippo.github.io/warp-snap-sped/draft-hancke-webrtc-sped-latest.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-hancke-webrtc-sped/">https://datatracker.ietf.org/doc/draft-hancke-webrtc-sped/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        WG Working Group mailing list (<span><a href="mailto:tsvwg@ietf.org">mailto:tsvwg@ietf.org</a></span>),
        which is archived at <span><a href="https://example.com/WG">https://example.com/WG</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/tsvwg/">https://www.ietf.org/mailman/listinfo/tsvwg/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/fippo/warp-snap-sped">https://github.com/fippo/warp-snap-sped</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 7 August 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-embedding-dtls-in-stun" class="internal xref">Embedding DTLS in STUN</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-example-negotiation" class="internal xref">Example negotiation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-embedding-data-acknowledgem" class="internal xref">Embedding data, acknowledgements and resends</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-ice-procedures" class="internal xref">ICE procedures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-inband-discovery-and-negoti" class="internal xref">Inband discovery and negotiation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-receipt-acknowledgements" class="internal xref">Receipt acknowledgements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="auto internal xref">3.3.3</a>.  <a href="#name-completion-of-the-dtls-hand" class="internal xref">Completion of the DTLS handshake</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.4">
                    <p id="section-toc.1-1.3.2.3.2.4.1"><a href="#section-3.3.4" class="auto internal xref">3.3.4</a>.  <a href="#name-for-pairs-that-are-in-waiti" class="internal xref">For pairs that are in WAITING state</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.5">
                    <p id="section-toc.1-1.3.2.3.2.5.1"><a href="#section-3.3.5" class="auto internal xref">3.3.5</a>.  <a href="#name-for-pairs-in-succeeded-stat" class="internal xref">For pairs in SUCCEEDED state</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.6">
                    <p id="section-toc.1-1.3.2.3.2.6.1"><a href="#section-3.3.6" class="auto internal xref">3.3.6</a>.  <a href="#name-resending-packets" class="internal xref">Resending packets</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.7">
                    <p id="section-toc.1-1.3.2.3.2.7.1"><a href="#section-3.3.7" class="auto internal xref">3.3.7</a>.  <a href="#name-sending-on-multiple-candida" class="internal xref">Sending on multiple candidate pairs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.8">
                    <p id="section-toc.1-1.3.2.3.2.8.1"><a href="#section-3.3.8" class="auto internal xref">3.3.8</a>.  <a href="#name-lite-agents" class="internal xref">Lite agents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-dtls-procedures" class="internal xref">DTLS procedures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-mtu-considerations" class="internal xref">MTU considerations</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="auto internal xref">3.4.2</a>.  <a href="#name-handling-flights-consisting" class="internal xref">Handling flights consisting of multiple packets</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-stun-extensions" class="internal xref">STUN Extensions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-new-attributes" class="internal xref">New attributes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-meta-dtls-in-stun" class="internal xref">META-DTLS-IN-STUN</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-meta-dtls-in-stun-acknowled" class="internal xref">META-DTLS-IN-STUN-ACKNOWLEDGEMENT</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-sdp-offer-answer-procedures" class="internal xref">SDP Offer/Answer Procedures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-generating-the-initial-sdp-" class="internal xref">Generating the Initial SDP Offer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-generating-the-sdp-answer" class="internal xref">Generating the SDP Answer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-offerer-processing-of-the-s" class="internal xref">Offerer Processing of the SDP Answer</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-modifying-the-session" class="internal xref">Modifying the Session</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-dtls-security-consideration" class="internal xref">DTLS security considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-pacing-and-congestion" class="internal xref">Pacing and Congestion</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-prior-work" class="internal xref">Prior Work</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-ice-dtls" class="internal xref">ICE-DTLS</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The current WebRTC connection setup, as outlined in <span>[<a href="#RFC8829" class="cite xref">RFC8829</a>]</span>, incurs 4 RTTs before media can be sent and 6 RTTs before the data channel opens. The serialization of ICE and DTLS is a large contributor to that as illustrated below (for DTLS 1.2):<a href="#section-1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-1-2">
<pre>
Client                                       Server
   |                                            |
   |------------- SDP Offer (actpass)----------&gt;|
   |&lt;-1---------- SDP Answer (passive)----------|
   |                                            |
   |&lt;-2---------- ICE/Connectivity Checks -----&gt;|
   |                                            |
   |------------- DTLS ClientHello ------------&gt;|
   |&lt;-3---------- DTLS ServerHello -------------|
   |------------- DTLS Finished ---------------&gt;|
   |&lt;-4---------- DTLS Finished ----------------|
   |                                            |
   |------------- Application data ------------&gt;|
</pre><a href="#section-1-2" class="pilcrow">¶</a>
</div>
<p id="section-1-3">In addition, deployment experience has shown reliability issues, caused by packet loss and the exponential backoff timer of DTLS implementation, particularly on connections with a high round-trip time. The underlying ICE layer, in contrast, uses periodic checks without exponential backoff.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The protocol defined in this specification aims to reduce this by embedding the DTLS handshake into STUN which eliminates the delay caused by the serialization of the protocols and enhances reliability with more frequent resends and acknowledgements.
The protocol is backward compatible with existing mechanisms for demultiplexing multiple ICE sessions on a single port, a common practice for ICE servers.
The protocol is designed for use with DTLS 1.2 <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span> and DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>. It can also accommodate post-quantum cryptography (PQC) which can significantly increase the size of DTLS handshake flights and number of packets.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The mechanism described can reduce the number of round-trips for session establishment, in some scenarios to as little as a single round-trip, which is comparable to the latency of the SDES key exchange mechanism <span>[<a href="#RFC4568" class="cite xref">RFC4568</a>]</span>.<a href="#section-1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1"><strong>DTLS Flight</strong>: A set of DTLS handshake messages sent by one peer as defined in <span><a href="https://rfc-editor.org/rfc/rfc9147#section-4" class="relref">Section 4</a> of [<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>. A flight can consist of one or more messages, which may be split into multiple DTLS records.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2"><strong>ICE Candidate</strong>: A transport address, consisting of an IP address and port, that is a potential point of contact for communication with a peer.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3"><strong>ICE candidate pair</strong>: A pair consisting of a local and a remote ice candidate. Initially, it is unknown whether the pair is usable for sending data or not, but this is explored by the ICE agents.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4"><strong>ICE Agent</strong>: A peer acting according to the ICE protocol. This involves enumerating local ICE candidates and sending them to the peer, and systematically trying ICE Candidate pairs for usability.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5"><strong>ICE Lite (Agent)</strong>: A peer using a subset of the ICE procedure that does not send STUN binding requests but only replies to them. ICE Lite is typically used on servers.<a href="#section-2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="embedding-dtls-in-stun">
<section id="section-3">
      <h2 id="name-embedding-dtls-in-stun">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-embedding-dtls-in-stun" class="section-name selfRef">Embedding DTLS in STUN</a>
      </h2>
<div id="example-negotiation">
<section id="section-3.1">
        <h3 id="name-example-negotiation">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-example-negotiation" class="section-name selfRef">Example negotiation</a>
        </h3>
<p id="section-3.1-1">The normal negotiation process serializes DTLS after STUN as shown below for a DTLS 1.3 handshake:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-2">
<pre>
Client                                       Server
   |                                            |
   |------------- SDP Offer (actpass)----------&gt;|
   |&lt;-1---------- SDP Answer (passive)----------|
   |                                            |
   |&lt;-2---------- ICE/Connectivity Checks -----&gt;|
   |                                            |
   |------------- DTLS ClientHello ------------&gt;|
   |&lt;-3---------- DTLS ServerHello/Fin----------|
   |------------- DTLS Finished ---------------&gt;|
   |------------- Application data ------------&gt;|
</pre><a href="#section-3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1-3">Embedding the DTLS handshake into the STUN Binding Requests reduces the setup time by one RTT:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-4">
<pre>
Client                                       Server
   |                                            |
   |------------- SDP Offer (actpass) ---------&gt;|
   |&lt;-1---------- SDP Answer (passive) --------&gt;|
   |                                            |
   |----- ICE Check + DTLS ClientHello --------&gt;|
   |&lt;-2-- ICE Response + DTLS ServerHello/Fin --|
   |----- DTLS Finished (lost) --------x        |
   |------------- Application data ------------&gt;|
   |----- ICE Check + DTLS Finished (resend)---&gt;|
</pre><a href="#section-3.1-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="embedding-data-acknowledgements-and-resends">
<section id="section-3.2">
        <h3 id="name-embedding-data-acknowledgem">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-embedding-data-acknowledgem" class="section-name selfRef">Embedding data, acknowledgements and resends</a>
        </h3>
<p id="section-3.2-1">The protocol defined in this specification embeds DTLS data as a STUN attribute, similar to the DATA attribute defined in <span>[<a href="#RFC5766" class="cite xref">RFC5766</a>]</span>.
The recipient acknowledges data with this attribute using another STUN attribute containing a list of CRC-32 hashes of the data.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">In addition to allowing saving one round-trip time for establishing the connection this has also shown to be useful for dealing
with packet loss due to the higher frequency of ICE connectvity checks compared to DTLS resends (which commonly use an exponential backoff)
as well as utilizing that ICE is potentially probing multiple candidate pairs. This is particularly important for fragmented handshake packets,
such as those used in DTLS-PQC, where only one of many packets in a DTLS flight might be lost and need retransmission.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">While some of the semantics defined in this specification are specific to establishing the DTLS connection,
the concept of using STUN attributes, e.g. on the periodic STUN consent defined in <span>[<a href="#RFC7675" class="cite xref">RFC7675</a>]</span>,
as a transport for embedding data<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-4.1">
            <p id="section-3.2-4.1.1">whose receipt should be acknowledged<a href="#section-3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-4.2">
            <p id="section-3.2-4.2.1">should be sent on multiple paths<a href="#section-3.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-4.3">
            <p id="section-3.2-4.3.1">is not time-critical<a href="#section-3.2-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-5">is applicable on a wider scope and can be specified by defining STUN attribute pairs for data and acknowledgements.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ice">
<section id="section-3.3">
        <h3 id="name-ice-procedures">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-ice-procedures" class="section-name selfRef">ICE procedures</a>
        </h3>
<p id="section-3.3-1">To manage delivery of DTLS handshake packets, the ICE agent maintains a list of outbound DTLS packets that have not yet been acknowledged by the peer. Each packet is identified by a CRC-32 hash. Packets are resent until they are acknowledged or removed from the list of outbound packets.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">Packets can be sent embedded in STUN messages using the META-DTLS-IN-STUN attribute, or without embedding on a validated ICE candidate pair.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">The agent also maintains a list of the CRC-32 hashes of received DTLS handshake packets to send as acknowledgements to the peer.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<div id="inband-discovery-and-negotiation">
<section id="section-3.3.1">
          <h4 id="name-inband-discovery-and-negoti">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-inband-discovery-and-negoti" class="section-name selfRef">Inband discovery and negotiation</a>
          </h4>
<p id="section-3.3.1-1">The protocol is using in-band discovery to determine support in addition to the use of ice-options for negotiation using SDP offer/answer described in <a href="#sdp" class="auto internal xref">Section 5</a>.
This is necessary as the STUN binding requests may reach the offerer before the SDP answer.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">Until the DTLS handshake has finished, the ICE agent includes the META-DTLS-IN-STUN-ACKNOWLEDGEMENT and META-DTLS-IN-STUN
attributes in binding requests and responses as described below.<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3">As a "closing handshake" signaling that this protocol (and the embedded DTLS handshake) has finished, the ICE agent<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.1-4.1">
              <p id="section-3.3.1-4.1.1">stops including the META-DTLS-IN-STUN attribute in STUN messages it sends when receiving a STUN messages that includes an empty META-DTLS-IN-STUN attribute and a META-DTLS-IN-STUN-ACKNOWLEDGMENT attribute.<a href="#section-3.3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.1-4.2">
              <p id="section-3.3.1-4.2.1">stops including the META-DTLS-IN-STUN-ACKNOWLEDGEMENT attribute in STUN messages it sends when receiving a STUN message that includes a
META-DTLS-IN-STUN-ACKNOWLEDGEMENT attribute but no META-DTLS-IN-STUN attribute.<a href="#section-3.3.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.1-5">An ICE agent receiving a STUN binding request or response that contains neither a META-DTLS-IN-STUN-ACKNOWLEDGEMENT nor a
META-DTLS-IN-STUN attribute determines that the peer does not support the protocol defined in this specification
and stops including of these attributes.<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="receipt-acknowledgements">
<section id="section-3.3.2">
          <h4 id="name-receipt-acknowledgements">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-receipt-acknowledgements" class="section-name selfRef">Receipt acknowledgements</a>
          </h4>
<p id="section-3.3.2-1">An ICE agent maintains two lists related to DTLS packet delivery:<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2-2.1">
              <p id="section-3.3.2-2.1.1">A "pending" list of CRC-32 hashes of all outbound DTLS packets that have not yet been acknowledged.<a href="#section-3.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.2-2.2">
              <p id="section-3.3.2-2.2.1">A "received" list of CRC-32 hashes of all unique inbound DTLS packets that it has processed.<a href="#section-3.3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.2-3">When an agent sends a STUN message, it includes the contents of its "received" list in a META-DTLS-IN-STUN-ACKNOWLEDGEMENT attribute.
This list MUST be included, even if empty, until the ICE agent receives a STUN binding request or response that
contains a META-DTLS-IN-STUN-ACKNOWLEDGEMENT attribute but does not contain a META-DTLS-IN-STUN attribute. This
acts as a "closing handshake" for the embedding.<a href="#section-3.3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.3.2-4">When an agent receives a STUN binding request or response containing a META-DTLS-IN-STUN attribute, it calculates the CRC-32 hash of the embedded DTLS packet.
If this hash is not already in its "received" list, it adds it.<a href="#section-3.3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.3.2-5">An outbound DTLS packet is considered acknowledged and removed from the "pending" list if either of these conditions is met:<a href="#section-3.3.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2-6.1">
              <p id="section-3.3.2-6.1.1">A STUN message is received from the peer containing a META-DTLS-IN-STUN-ACKNOWLEDGEMENT attribute that includes the packet's CRC-32 hash.<a href="#section-3.3.2-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.2-6.2">
              <p id="section-3.3.2-6.2.1">For a DTLS packet sent embedded in a STUN binding request, a STUN binding success response is received for that request. This serves as an implicit acknowledgement.<a href="#section-3.3.2-6.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.2-7">The "pending" list is cleared when the DTLS layer signals that<a href="#section-3.3.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.2-8.1">
              <p id="section-3.3.2-8.1.1">a new flight is going to be sent.<a href="#section-3.3.2-8.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.2-8.2">
              <p id="section-3.3.2-8.2.1">the current flight of packets has timed out and a resend is going to happen.<a href="#section-3.3.2-8.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="completion-of-the-dtls-handshake">
<section id="section-3.3.3">
          <h4 id="name-completion-of-the-dtls-hand">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-completion-of-the-dtls-hand" class="section-name selfRef">Completion of the DTLS handshake</a>
          </h4>
<p id="section-3.3.3-1">The DTLS layer MUST notify the ICE agent when the DTLS handshake is complete, its role and what DTLS version was negotiated.<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3.3-2">The ICE agent clears the "pending" list of outgoing packets if either
* the DTLS layer is acting as a DTLS client and the DTLS version is 1.2, or
* the DTLS layer is acting as a DTLS server and the DTLS version is 1.3.<a href="#section-3.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="for-pairs-that-are-in-waiting-state">
<section id="section-3.3.4">
          <h4 id="name-for-pairs-that-are-in-waiti">
<a href="#section-3.3.4" class="section-number selfRef">3.3.4. </a><a href="#name-for-pairs-that-are-in-waiti" class="section-name selfRef">For pairs that are in WAITING state</a>
          </h4>
<p id="section-3.3.4-1">When an ICE candidate pair has not received a response, DTLS can not be sent without being embedded as the candidate pair does not have consent
from the other side. In that state, when sending a STUN binding request the ICE agent embeds<a href="#section-3.3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.4-2.1">
              <p id="section-3.3.4-2.1.1">any pending acknowledgments using the META-DTLS-IN-STUN-ACKNOWLEDGMENT attribute and<a href="#section-3.3.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.4-2.2">
              <p id="section-3.3.4-2.2.1">the next pending DTLS packet (e.g. determined in a round-robin fashion) using the META-DTLS-IN-STUN attribute. If the "pending" list is empty, the attribute MUST be included with a zero-length value.<a href="#section-3.3.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.3.4-3">When receiving a binding request with an META-DTLS-IN-STUN attribute, the ICE agents embeds<a href="#section-3.3.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.4-4.1">
              <p id="section-3.3.4-4.1.1">any pending acknowledgments using the META-DTLS-IN-STUN-ACKNOWLEDGMENT attribute and<a href="#section-3.3.4-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.4-4.2">
              <p id="section-3.3.4-4.2.1">the next pending DTLS packet (e.g. determined in a round-robin fashion) using the META-DTLS-IN-STUN attribute. If the "pending" list is empty, the attribute MUST be included with a zero-length value.<a href="#section-3.3.4-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="for-pairs-in-succeeded-state">
<section id="section-3.3.5">
          <h4 id="name-for-pairs-in-succeeded-stat">
<a href="#section-3.3.5" class="section-number selfRef">3.3.5. </a><a href="#name-for-pairs-in-succeeded-stat" class="section-name selfRef">For pairs in SUCCEEDED state</a>
          </h4>
<p id="section-3.3.5-1">When the ICE candidate pair has received a binding response and is in succeeded state, any new DTLS flights SHOULD immediately be sent without being embedded in
STUN or waiting for the next ICE check. This avoids race conditions where the last part of the DTLS handshake is buffered waiting for the next STUN packet
while DTLS data is already sent ahead of the final handshake packets.<a href="#section-3.3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.3.5-2">When the STUN agent is sending a scheduled check as described in <span><a href="https://rfc-editor.org/rfc/rfc5245#section-5.8" class="relref">Section 5.8</a> of [<a href="#RFC5245" class="cite xref">RFC5245</a>]</span> it SHOULD embed<a href="#section-3.3.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.3.5-3.1">
              <p id="section-3.3.5-3.1.1">any pending acknowledgments using the META-DTLS-IN-STUN-ACKNOWLEDGMENT attribute and<a href="#section-3.3.5-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.3.5-3.2">
              <p id="section-3.3.5-3.2.1">the next pending DTLS packet (e.g. determined in a round-robin fashion) using the META-DTLS-IN-STUN attribute.<a href="#section-3.3.5-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="resending-packets">
<section id="section-3.3.6">
          <h4 id="name-resending-packets">
<a href="#section-3.3.6" class="section-number selfRef">3.3.6. </a><a href="#name-resending-packets" class="section-name selfRef">Resending packets</a>
          </h4>
<p id="section-3.3.6-1">Resends should happen with the regularly scheduled ICE checks but MAY be triggered by the receipt of an acknowledgment and determining that a
packet did not arrive as expected (either because it was lost or it arrived out of order).<a href="#section-3.3.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sending-on-multiple-candidate-pairs">
<section id="section-3.3.7">
          <h4 id="name-sending-on-multiple-candida">
<a href="#section-3.3.7" class="section-number selfRef">3.3.7. </a><a href="#name-sending-on-multiple-candida" class="section-name selfRef">Sending on multiple candidate pairs</a>
          </h4>
<p id="section-3.3.7-1">ICE performs checks on multiple candidate pairs in parallel. This implies that embedding a DTLS packet
can happen in rapid succession without the packet embedded first having a chance to reach the peer and
the other side will potentially receive many duplicated DTLS packets.<a href="#section-3.3.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lite-agents">
<section id="section-3.3.8">
          <h4 id="name-lite-agents">
<a href="#section-3.3.8" class="section-number selfRef">3.3.8. </a><a href="#name-lite-agents" class="section-name selfRef">Lite agents</a>
          </h4>
<p id="section-3.3.8-1">Lite ICE agents which are commonly used by servers by definition only respond to binding requests and do not send
binding requests themselves. Due to the lock-step behavior of DTLS this is not a problem, also Lite ICE Agents
can send DTLS without embedding once they received a valid binding request from a peer.<a href="#section-3.3.8-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dtls-procedures">
<section id="section-3.4">
        <h3 id="name-dtls-procedures">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-dtls-procedures" class="section-name selfRef">DTLS procedures</a>
        </h3>
<p id="section-3.4-1">For the protocol described in this specification the DTLS handshake is started before ICE finds a valid pair.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">Instead of receiving the DTLS packets after demultiplexing (described in <span><a href="https://rfc-editor.org/rfc/rfc7983#section-7" class="relref">Section 7</a> of [<a href="#RFC7983" class="cite xref">RFC7983</a>]</span>),
the DTLS layer receives packets from the ICE layer directly.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<div id="mtu-considerations">
<section id="section-3.4.1">
          <h4 id="name-mtu-considerations">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-mtu-considerations" class="section-name selfRef">MTU considerations</a>
          </h4>
<p id="section-3.4.1-1">Embedding DTLS in STUN requires considerations for reducing the MTU used by the DTLS layer for the fragmentation of the handshake.
The goal is to fit the DTLS handshake packets into STUN packets with a predefined maximum size.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<p id="section-3.4.1-2">The following attributes must be taken into account:<a href="#section-3.4.1-2" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
            <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Attribute</th>
                <th class="text-left" rowspan="1" colspan="1">Size</th>
                <th class="text-left" rowspan="1" colspan="1">Defined in</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">STUN header</td>
                <td class="text-left" rowspan="1" colspan="1">20</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span>[<a href="#RFC8489" class="cite xref">RFC8489</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">ICE-CONTROLLED /ICE-CONTROLLING</td>
                <td class="text-left" rowspan="1" colspan="1">12</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span><a href="https://rfc-editor.org/rfc/rfc8445#section-7.3.1" class="relref">Section 7.3.1</a> of [<a href="#RFC8445" class="cite xref">RFC8445</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">PRIORITY</td>
                <td class="text-left" rowspan="1" colspan="1">8</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span><a href="https://rfc-editor.org/rfc/rfc8445#section-7.3.1" class="relref">Section 7.3.1</a> of [<a href="#RFC8445" class="cite xref">RFC8445</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">USE-CANDIDATE</td>
                <td class="text-left" rowspan="1" colspan="1">4</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span><a href="https://rfc-editor.org/rfc/rfc8445#section-7.3.1" class="relref">Section 7.3.1</a> of [<a href="#RFC8445" class="cite xref">RFC8445</a>]</span>, not on first packet but subsequent packets</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">MESSAGE-INTEGRITY</td>
                <td class="text-left" rowspan="1" colspan="1">24</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span><a href="https://rfc-editor.org/rfc/rfc8489#section-15.4" class="relref">Section 15.4</a> of [<a href="#RFC8489" class="cite xref">RFC8489</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">FINGERPRINT</td>
                <td class="text-left" rowspan="1" colspan="1">8</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span><a href="https://rfc-editor.org/rfc/rfc8489#section-15.5" class="relref">Section 15.5</a> of [<a href="#RFC8489" class="cite xref">RFC8489</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">DTLS-in-STUN</td>
                <td class="text-left" rowspan="1" colspan="1">4</td>
                <td class="text-left" rowspan="1" colspan="1">This specification. Overhead for the attribute header.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">DTLS-in-STUN-ACKNOWLEDGEMENT</td>
                <td class="text-left" rowspan="1" colspan="1">20</td>
                <td class="text-left" rowspan="1" colspan="1">This specification.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">USERNAME</td>
                <td class="text-left" rowspan="1" colspan="1">16+</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <span><a href="https://rfc-editor.org/rfc/rfc8445#section-7.3.1" class="relref">Section 7.3.1</a> of [<a href="#RFC8445" class="cite xref">RFC8445</a>]</span>. Variable, typically 4 byte header plus 9 bytes for two four-byte username fragments and the colon plus 3 bytes padding. The actual size is known before the DTLS exchange starts, either from the SDP exchange or a peer-reflexive candidate.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">TURN XOR-PEER-ADDRESS</td>
                <td class="text-left" rowspan="1" colspan="1">24</td>
                <td class="text-left" rowspan="1" colspan="1">Assuming 16 bytes IPv6, see <span>[<a href="#RFC8656" class="cite xref">RFC8656</a>]</span>
</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Total</td>
                <td class="text-left" rowspan="1" colspan="1">124+</td>
                <td class="text-left" rowspan="1" colspan="1"> </td>
              </tr>
            </tbody>
          </table>
<p id="section-3.4.1-4">Applications that use additional STUN attributes MUST reduce the DTLS MTU further.
The reduced MTU should only be used until the DTLS handshake is complete.<a href="#section-3.4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="handling-flights-consisting-of-multiple-packets">
<section id="section-3.4.2">
          <h4 id="name-handling-flights-consisting">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-handling-flights-consisting" class="section-name selfRef">Handling flights consisting of multiple packets</a>
          </h4>
<p id="section-3.4.2-1">A single DTLS flight may be too large to fit into a single UDP packet, especially when using Post-Quantum Cryptography (PQC).<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.4.2-2">Addressing this without re-introducing additional delays is an open question.<a href="#section-3.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="stun-extensions">
<section id="section-4">
      <h2 id="name-stun-extensions">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-stun-extensions" class="section-name selfRef">STUN Extensions</a>
      </h2>
<div id="new-attributes">
<section id="section-4.1">
        <h3 id="name-new-attributes">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-new-attributes" class="section-name selfRef">New attributes</a>
        </h3>
<p id="section-4.1-1">This specification extends <span>[<a href="#RFC8489" class="cite xref">RFC8489</a>]</span> and defines two new attributes, META-DTLS-IN-STUN and
META-DTLS-IN-STUN-ACKNOWLEDGEMENT. These attributes are comprehension-optional.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="meta-dtls-in-stun">
<section id="section-4.2">
        <h3 id="name-meta-dtls-in-stun">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-meta-dtls-in-stun" class="section-name selfRef">META-DTLS-IN-STUN</a>
        </h3>
<p id="section-4.2-1">The META-DTLS-IN-STUN attribute may be present in binding requests, responses and indications.  The value portion of this attribute is variable length and
consists of the DTLS handshake flights as described in <span><a href="https://rfc-editor.org/rfc/rfc9147#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC9147" class="cite xref">RFC9147</a>]</span> or <span><a href="https://rfc-editor.org/rfc/rfc6347#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC6347" class="cite xref">RFC6347</a>]</span>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">If the length of this attribute is not a multiple of 4, then padding must be added after this attribute. If the value portion of this attribute is empty
or the first byte is not DTLS (i.e. between 20 and 63 (inclusive) as described in <span><a href="https://rfc-editor.org/rfc/rfc9443#section-3" class="relref">Section 3</a> of [<a href="#RFC9443" class="cite xref">RFC9443</a>]</span>) the attribute SHOULD be silently discarded<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Once the DTLS handshake is completed this attribute SHOULD be silently discarded.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="meta-dtls-in-stun-acknowledgement">
<section id="section-4.3">
        <h3 id="name-meta-dtls-in-stun-acknowled">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-meta-dtls-in-stun-acknowled" class="section-name selfRef">META-DTLS-IN-STUN-ACKNOWLEDGEMENT</a>
        </h3>
<p id="section-4.3-1">TODO(NEEDS CONSENSUS): does this attribute have a maximum length?<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">The META-DTLS-IN-STUN-ACKNOWLEDGEMENT attribute may be present in binding requests, responses and  indications. The value portion of this attribute is
variable length and consists of up to four CRC-32 values that are computed for the META-DTLS-IN-STUN values whose receipt the sender acknowledges
(similar to the STUN FINGERPRINT attribute defined in <span><a href="https://rfc-editor.org/rfc/rfc8489#section-15.5" class="relref">Section 15.5</a> of [<a href="#RFC8489" class="cite xref">RFC8489</a>]</span>.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">If the length of the value is not a multiple of four or exceeds 16 bytes this attribute SHOULD be silently discarded.
The order does not need to match the order in which the packets were received.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">The attribute MAY be empty but included in a binding request or binding response to signal support for the protocol defined in this specification.
This typically happens when the SDP answerer has a "passive" DTLS role and sends binding requests which may arrive at the SDP offerer before the answer.
It is recommended that this attribute is included before the META-DTLS-IN-STUN attribute.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sdp">
<section id="section-5">
      <h2 id="name-sdp-offer-answer-procedures">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-sdp-offer-answer-procedures" class="section-name selfRef">SDP Offer/Answer Procedures</a>
      </h2>
<p id="section-5-1">TODO(NEEDS CONSENSUS): is this needed?<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The protocol is designed to work with in-band discovery as described above. If negotiating the protocol via the SDP
offer/answer mechanism using the 'ice-options' attribute is desired, the procedures for that are outlined below.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="generating-the-initial-sdp-offer">
<section id="section-5.1">
        <h3 id="name-generating-the-initial-sdp-">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-generating-the-initial-sdp-" class="section-name selfRef">Generating the Initial SDP Offer</a>
        </h3>
<p id="section-5.1-1">If the offering endpoint supports the extension defined in this specification, it includes the "sped" ICE option in the SDP.
The offerer MUST be prepared to receive the STUN attributes described below even before receiving the SDP answer.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="generating-the-sdp-answer">
<section id="section-5.2">
        <h3 id="name-generating-the-sdp-answer">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-generating-the-sdp-answer" class="section-name selfRef">Generating the SDP Answer</a>
        </h3>
<p id="section-5.2-1">An answering endpoint not supporting the ice-option described in this document must not include it in its response.
Otherwise the endpoint includes the "sped" ice-option in its answer and can start using the STUN attributes using the semantics defined in <a href="#ice" class="auto internal xref">Section 3.3</a>.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="offerer-processing-of-the-sdp-answer">
<section id="section-5.3">
        <h3 id="name-offerer-processing-of-the-s">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-offerer-processing-of-the-s" class="section-name selfRef">Offerer Processing of the SDP Answer</a>
        </h3>
<p id="section-5.3-1">If the answer does not include the "sped" ice-option, the offerer SHOULD ignore the STUN attributes defined in this specification
and MUST NOT send them. Otherwise the offerer includes the STUN attributes using the semantics defined in <a href="#ice" class="auto internal xref">Section 3.3</a>.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="modifying-the-session">
<section id="section-5.4">
        <h3 id="name-modifying-the-session">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-modifying-the-session" class="section-name selfRef">Modifying the Session</a>
        </h3>
<p id="section-5.4-1">Subsequent offers and answers MUST include the ice-option in the negotiated SDP with the same value as in the initial negotiation.
Remote offers MAY renegotiate ice-options only when negotiating a new DTLS association as described in <span><a href="https://rfc-editor.org/rfc/rfc8842#section-5.5" class="relref">Section 5.5</a> of [<a href="#RFC8842" class="cite xref">RFC8842</a>]</span>.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="dtls-security-considerations">
<section id="section-6.1">
        <h3 id="name-dtls-security-consideration">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-dtls-security-consideration" class="section-name selfRef">DTLS security considerations</a>
        </h3>
<p id="section-6.1-1">This specification uses application layer caching of DTLS packets which means packets may be sent multiple times using the same
sequence number. For the receiver these will be considered a replay if received multiple times and rejected as described in <span><a href="https://rfc-editor.org/rfc/rfc9147#section-4.5.1" class="relref">Section 4.5.1</a> of [<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The embedded DTLS handshake is authenticated by the ICE username and message-integrity.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pacing-and-congestion">
<section id="section-6.2">
        <h3 id="name-pacing-and-congestion">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-pacing-and-congestion" class="section-name selfRef">Pacing and Congestion</a>
        </h3>
<p id="section-6.2-1">The protocol defined in this specification increases the size of the STUN packets that are sent by the ICE agent to a peer without
knowing if that peer consents to receiving the packets. The STUN requests used for embedding DTLS are already paced as described
in <span><a href="https://rfc-editor.org/rfc/rfc8845#appendix-B.1" class="relref">Appendix B.1</a> of [<a href="#RFC8845" class="cite xref">RFC8845</a>]</span> which should prevent issues.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document defines two new STUN attributes, META-DTLS-IN-STUN and META-DTLS-IN-STUN-ACKNOWLEDGEMENT. These attributes will need to be registered with IANA in the "STUN Attributes" registry, following the procedures defined in <span>[<a href="#RFC8489" class="cite xref">RFC8489</a>]</span>. Provisional names have been used in this draft and the registry.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">If an ice-option is considered necessary, the IANA shall register the following ICE option in the "ICE Options" subregistry of the
"Interactive Connectivity Establishment (ICE) registry", following the procedures defined in <span>[<a href="#RFC6336" class="cite xref">RFC6336</a>]</span>.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3"><strong>ICE Option</strong>: sped<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4"><strong>Contact</strong>: TODO<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5"><strong>Change controller</strong>: TODO<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6"><strong>Description</strong>: An ICE option of 'sped' indicates support for embedding DTLS in STUN as described in this specification.<a href="#section-7-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="prior-work">
<section id="section-8">
      <h2 id="name-prior-work">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-prior-work" class="section-name selfRef">Prior Work</a>
      </h2>
<div id="ice-dtls">
<section id="section-8.1">
        <h3 id="name-ice-dtls">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-ice-dtls" class="section-name selfRef">ICE-DTLS</a>
        </h3>
<p id="section-8.1-1">The ICE-DTLS draft from 2012 proposed a similar mechanism to SPED, in which a single RTT could be removed from session setup by
replacing STUN Request and Response messages with DTLS ClientHello and ServerHello messages (rather than piggybacking the DTLS
messages as described in this document).<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">The ICE-DTLS mechanism ends up being considerably more complex than the protocol described in this document , on account of the fact
that the entirety of ICE functionality needs to be ported over to DTLS (eg consent checks) or retained as a complementary approach
(e.g. peer address discovery). Furthermore, since it changes the details of connectivity negotiation, it is not backward compatible
and therefore must be negotiated via SDP ice-options.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">Embedding DTLS in STUN is, on the other hand, is inherently backward compatible with existing WebRTC implementations.
It is also more compatible with demultiplexing multiple ICE sessions using different STUN username fragments on the same UDP port.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-combined-references">
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC8842">[RFC8842]</dt>
        <dd>
<span class="refAuthor">Holmberg, C.</span> and <span class="refAuthor">R. Shpount</span>, <span class="refTitle">"Session Description Protocol (SDP) Offer/Answer Considerations for Datagram Transport Layer Security (DTLS) and Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 8842</span>, <span class="seriesInfo">DOI 10.17487/RFC8842</span>, <time datetime="2021-01" class="refDate">January 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8842">https://www.rfc-editor.org/rfc/rfc8842</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9443">[RFC9443]</dt>
      <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Salgueiro, G.</span>, and <span class="refAuthor">C. Perkins</span>, <span class="refTitle">"Multiplexing Scheme Updates for QUIC"</span>, <span class="seriesInfo">RFC 9443</span>, <span class="seriesInfo">DOI 10.17487/RFC9443</span>, <time datetime="2023-07" class="refDate">July 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9443">https://www.rfc-editor.org/rfc/rfc9443</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC4568">[RFC4568]</dt>
        <dd>
<span class="refAuthor">Andreasen, F.</span>, <span class="refAuthor">Baugher, M.</span>, and <span class="refAuthor">D. Wing</span>, <span class="refTitle">"Session Description Protocol (SDP) Security Descriptions for Media Streams"</span>, <span class="seriesInfo">RFC 4568</span>, <span class="seriesInfo">DOI 10.17487/RFC4568</span>, <time datetime="2006-07" class="refDate">July 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4568">https://www.rfc-editor.org/rfc/rfc4568</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5245">[RFC5245]</dt>
        <dd>
<span class="refAuthor">Rosenberg, J.</span>, <span class="refTitle">"Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols"</span>, <span class="seriesInfo">RFC 5245</span>, <span class="seriesInfo">DOI 10.17487/RFC5245</span>, <time datetime="2010-04" class="refDate">April 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5245">https://www.rfc-editor.org/rfc/rfc5245</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5766">[RFC5766]</dt>
        <dd>
<span class="refAuthor">Mahy, R.</span>, <span class="refAuthor">Matthews, P.</span>, and <span class="refAuthor">J. Rosenberg</span>, <span class="refTitle">"Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN)"</span>, <span class="seriesInfo">RFC 5766</span>, <span class="seriesInfo">DOI 10.17487/RFC5766</span>, <time datetime="2010-04" class="refDate">April 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5766">https://www.rfc-editor.org/rfc/rfc5766</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6336">[RFC6336]</dt>
        <dd>
<span class="refAuthor">Westerlund, M.</span> and <span class="refAuthor">C. Perkins</span>, <span class="refTitle">"IANA Registry for Interactive Connectivity Establishment (ICE) Options"</span>, <span class="seriesInfo">RFC 6336</span>, <span class="seriesInfo">DOI 10.17487/RFC6336</span>, <time datetime="2011-07" class="refDate">July 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6336">https://www.rfc-editor.org/rfc/rfc6336</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6347">https://www.rfc-editor.org/rfc/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7675">[RFC7675]</dt>
        <dd>
<span class="refAuthor">Perumal, M.</span>, <span class="refAuthor">Wing, D.</span>, <span class="refAuthor">Ravindranath, R.</span>, <span class="refAuthor">Reddy, T.</span>, and <span class="refAuthor">M. Thomson</span>, <span class="refTitle">"Session Traversal Utilities for NAT (STUN) Usage for Consent Freshness"</span>, <span class="seriesInfo">RFC 7675</span>, <span class="seriesInfo">DOI 10.17487/RFC7675</span>, <time datetime="2015-10" class="refDate">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7675">https://www.rfc-editor.org/rfc/rfc7675</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7983">[RFC7983]</dt>
        <dd>
<span class="refAuthor">Petit-Huguenin, M.</span> and <span class="refAuthor">G. Salgueiro</span>, <span class="refTitle">"Multiplexing Scheme Updates for Secure Real-time Transport Protocol (SRTP) Extension for Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7983</span>, <span class="seriesInfo">DOI 10.17487/RFC7983</span>, <time datetime="2016-09" class="refDate">September 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7983">https://www.rfc-editor.org/rfc/rfc7983</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8445">[RFC8445]</dt>
        <dd>
<span class="refAuthor">Keranen, A.</span>, <span class="refAuthor">Holmberg, C.</span>, and <span class="refAuthor">J. Rosenberg</span>, <span class="refTitle">"Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal"</span>, <span class="seriesInfo">RFC 8445</span>, <span class="seriesInfo">DOI 10.17487/RFC8445</span>, <time datetime="2018-07" class="refDate">July 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8445">https://www.rfc-editor.org/rfc/rfc8445</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8489">[RFC8489]</dt>
        <dd>
<span class="refAuthor">Petit-Huguenin, M.</span>, <span class="refAuthor">Salgueiro, G.</span>, <span class="refAuthor">Rosenberg, J.</span>, <span class="refAuthor">Wing, D.</span>, <span class="refAuthor">Mahy, R.</span>, and <span class="refAuthor">P. Matthews</span>, <span class="refTitle">"Session Traversal Utilities for NAT (STUN)"</span>, <span class="seriesInfo">RFC 8489</span>, <span class="seriesInfo">DOI 10.17487/RFC8489</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8489">https://www.rfc-editor.org/rfc/rfc8489</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8656">[RFC8656]</dt>
        <dd>
<span class="refAuthor">Reddy, T., Ed.</span>, <span class="refAuthor">Johnston, A., Ed.</span>, <span class="refAuthor">Matthews, P.</span>, and <span class="refAuthor">J. Rosenberg</span>, <span class="refTitle">"Traversal Using Relays around NAT (TURN): Relay Extensions to Session Traversal Utilities for NAT (STUN)"</span>, <span class="seriesInfo">RFC 8656</span>, <span class="seriesInfo">DOI 10.17487/RFC8656</span>, <time datetime="2020-02" class="refDate">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8656">https://www.rfc-editor.org/rfc/rfc8656</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8829">[RFC8829]</dt>
        <dd>
<span class="refAuthor">Uberti, J.</span>, <span class="refAuthor">Jennings, C.</span>, and <span class="refAuthor">E. Rescorla, Ed.</span>, <span class="refTitle">"JavaScript Session Establishment Protocol (JSEP)"</span>, <span class="seriesInfo">RFC 8829</span>, <span class="seriesInfo">DOI 10.17487/RFC8829</span>, <time datetime="2021-01" class="refDate">January 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8829">https://www.rfc-editor.org/rfc/rfc8829</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8845">[RFC8845]</dt>
        <dd>
<span class="refAuthor">Duckworth, M., Ed.</span>, <span class="refAuthor">Pepperell, A.</span>, and <span class="refAuthor">S. Wenger</span>, <span class="refTitle">"Framework for Telepresence Multi-Streams"</span>, <span class="seriesInfo">RFC 8845</span>, <span class="seriesInfo">DOI 10.17487/RFC8845</span>, <time datetime="2021-01" class="refDate">January 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8845">https://www.rfc-editor.org/rfc/rfc8845</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9147">https://www.rfc-editor.org/rfc/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
    </h2>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Philipp Hancke</span></div>
<div dir="auto" class="left"><span class="org">Meta Platforms Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:philipp.hancke@googlemail.com" class="email">philipp.hancke@googlemail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
